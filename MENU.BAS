OPEN "MENU.CSV" FOR INPUT AS 1
DIM NAMES(23) AS STRING
DIM CWD(23) AS STRING
DIM EXE(23) AS STRING
SEL = 1

INDEX = 1
DO WHILE NOT EOF(1)
INPUT #1, NAME$(INDEX), CWD$(INDEX), EXE$(INDEX)
INDEX = INDEX + 1
LOOP

MAXLEN = 0
FOR I = 1 TO (INDEX - 1)
L = LEN(NAME$(I)) + 2
IF L > MAXLEN THEN MAXLEN = L
NEXT I
GOSUB 50

OK$ = CHR$(13)
REM CHR$(0) + CHR$(28)
UP$ = CHR$(0) + CHR$(72)
DOWN$ = CHR$(0) + CHR$(80)

DO
KEY$ = INKEY$
REM IF KEY$ <> "" THEN PRINT "KEY: '"; ASC(RIGHT$(KEY$, 1)); "'"
IF KEY$ = OK$ THEN GOSUB 60
IF KEY$ = UP$ THEN IF SEL > 1 THEN SEL = SEL - 1
IF KEY$ = DOWN$ THEN IF SEL < (INDEX - 1) THEN SEL = SEL + 1
IF KEY$ = CHR$(27) THEN END
IF KEY$ = UP$ OR KEY$ = DOWN$ THEN GOSUB 50
LOOP
END

50 REM SUB SHOW
CLS
SHOW$ = STRING$(80, " ")
T$ = CHR$(218) + STRING$(MAXLEN - 2, 196) + CHR$(191)
MID$(SHOW$, (80 - LEN(T$)) / 2) = T$
PRINT SHOW$
FOR I = 1 TO (INDEX - 1)
C$ = CHR$(179)
IF I = SEL THEN C$ = CHR$(186)
SHOW$ = STRING$(80, " ")
SQ$ = C$ + STRING$(MAXLEN - 2, " ") + C$
MID$(SQ$, ((MAXLEN + 2) - LEN(NAME$(I))) / 2) = NAME$(I)
MID$(SHOW$, (80 - LEN(SQ$)) / 2) = SQ$
PRINT SHOW$
NEXT I
T$ = CHR$(192) + STRING$(MAXLEN - 2, 196) + CHR$(217)
MID$(SHOW$, (80 - LEN(T$)) / 2) = T$
PRINT SHOW$
RETURN

60 REM SUB RUN
CLS
CHDIR CWD$(SEL)
SHELL EXE$(SEL)
SHELL "PAUSE"
GOSUB 50
RETURN

